{# templates/article.html #}
{% extends "base.html" %}

{% block article_header %}
  <header class="article-header">
    <h1 class="article-title">{{ article.title }}</h1>
    <p class="metadata">
      {% if article.lang == 'zh' %}创建时间{% else %}Created{% endif %}: {{ article.date.strftime('%Y-%m-%d') }}
    </p>
  </header>
{% endblock %}

{% block content %}

{# 语言切换（文章页，自动互链；无译文时退回站点入口） #}
{% set cur_lang = (article.lang if article and article.lang else DEFAULT_LANG) %}
{% set zh_url = None %}
{% set en_url = None %}
{% if article.translations %}
  {% for tr in article.translations %}
    {% if tr.lang == 'zh' %}{% set zh_url = tr.url %}{% endif %}
    {% if tr.lang == 'en' %}{% set en_url = tr.url %}{% endif %}
  {% endfor %}
{% endif %}
{% if not zh_url %}{% set zh_url = SITEURL ~ '/zh/' %}{% endif %}
{% if not en_url %}{% set en_url = SITEURL or '/' %}{% endif %}

<nav class="lang-switch">
  <a href="{{ zh_url }}" onclick="setPrefLang('zh')" class="{{ 'active' if cur_lang == 'zh' else '' }}">中文</a>
  <a href="{{ en_url }}" onclick="setPrefLang('en')" class="{{ 'active' if cur_lang == 'en' else '' }}">EN</a>
</nav>

{{ article.content }}
{% endblock %}
